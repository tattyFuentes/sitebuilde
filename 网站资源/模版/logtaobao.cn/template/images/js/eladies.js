// [8,342,6] published at 2009-03-26 10:55:10

//舍签
function SubShowClass(ID,eventType,defaultID,openClassName,closeClassName){this.parentObj=SubShowClass.$(ID);if(this.parentObj==null&&ID!="none"){throw new Error("SubShowClass(ID)参数错误:ID 对像存在!(value:"+ID+")")};if(!SubShowClass.childs){SubShowClass.childs=[]};this.ID=SubShowClass.childs.length;SubShowClass.childs.push(this);this.lock=false;this.label=[];this.defaultID=defaultID==null?0:defaultID;this.selectedIndex=this.defaultID;this.openClassName=openClassName==null?"selected":openClassName;this.closeClassName=closeClassName==null?"":closeClassName;this.mouseIn=false;var mouseInFunc=Function("SubShowClass.childs["+this.ID+"].mouseIn = true"),mouseOutFunc=Function("SubShowClass.childs["+this.ID+"].mouseIn = false");if(ID!="none"){if(this.parentObj.attachEvent){this.parentObj.attachEvent("onmouseover",mouseInFunc)}else{this.parentObj.addEventListener("mouseover",mouseInFunc,false)}};if(ID!="none"){if(this.parentObj.attachEvent){this.parentObj.attachEvent("onmouseout",mouseOutFunc)}else{this.parentObj.addEventListener("mouseout",mouseOutFunc,false)}};if(typeof(eventType)!="string"){eventType="onmousedown"};eventType=eventType.toLowerCase();switch(eventType){case "onmouseover":this.eventType="mouseover";break;case "onmouseout":this.eventType="mouseout";break;case "onclick":this.eventType="click";break;case "onmouseup":this.eventType="mouseup";break;default:this.eventType="mousedown"};this.autoPlay=false;this.autoPlayTimeObj=null;this.spaceTime=5000};SubShowClass.prototype.version="1.30";SubShowClass.prototype.author="mengjia";SubShowClass.prototype.addLabel=function(labelID,contID,parentBg,springEvent,blurEvent){if(SubShowClass.$(labelID)==null&&labelID!="none"){throw new Error("addLabel(labelID)参数错误:labelID 对像存在!(value:"+labelID+")")};var TempID=this.label.length;if(parentBg==""){parentBg=null};this.label.push([labelID,contID,parentBg,springEvent,blurEvent]);var tempFunc=Function('SubShowClass.childs['+this.ID+'].select('+TempID+')');if(labelID!="none"){if(SubShowClass.$(labelID).attachEvent){SubShowClass.$(labelID).attachEvent("on"+this.eventType,tempFunc)}else{SubShowClass.$(labelID).addEventListener(this.eventType,tempFunc,false)}};if(TempID==this.defaultID){if(labelID!="none"){SubShowClass.$(labelID).className=this.openClassName};if(SubShowClass.$(contID)){SubShowClass.$(contID).style.display=""};if(this.ID!="none"){if(parentBg!=null){this.parentObj.style.background=parentBg}};if(springEvent!=null){eval(springEvent)}}else{if(labelID!="none"){SubShowClass.$(labelID).className=this.closeClassName};if(SubShowClass.$(contID)){SubShowClass.$(contID).style.display="none"}};var mouseInFunc=Function("SubShowClass.childs["+this.ID+"].mouseIn = true"),mouseOutFunc=Function("SubShowClass.childs["+this.ID+"].mouseIn = false");if(SubShowClass.$(contID)){if(SubShowClass.$(contID).attachEvent){SubShowClass.$(contID).attachEvent("onmouseover",mouseInFunc)}else{SubShowClass.$(contID).addEventListener("mouseover",mouseInFunc,false)};if(SubShowClass.$(contID).attachEvent){SubShowClass.$(contID).attachEvent("onmouseout",mouseOutFunc)}else{SubShowClass.$(contID).addEventListener("mouseout",mouseOutFunc,false)}}};SubShowClass.prototype.select=function(num,force){if(typeof(num)!="number"){throw new Error("select(num)参数错误:num 不是 number 类型!(value:"+num+")")};if(force!=true&&this.selectedIndex==num){return};var i;for(i=0;i<this.label.length;i++){if(i==num){if(this.label[i][0]!="none"){SubShowClass.$(this.label[i][0]).className=this.openClassName};if(SubShowClass.$(this.label[i][1])){SubShowClass.$(this.label[i][1]).style.display=""};if(this.ID!="none"){if(this.label[i][2]!=null){this.parentObj.style.background=this.label[i][2]}};if(this.label[i][3]!=null){eval(this.label[i][3])}}else if(this.selectedIndex==i||force==true){if(this.label[i][0]!="none"){SubShowClass.$(this.label[i][0]).className=this.closeClassName};if(SubShowClass.$(this.label[i][1])){SubShowClass.$(this.label[i][1]).style.display="none"};if(this.label[i][4]!=null){eval(this.label[i][4])}}};this.selectedIndex=num};SubShowClass.prototype.random=function(){var O=this;if(arguments.length!=O.label.length){throw new Error("random()参数错误:参数数量与标签数量不符!(length:"+arguments.length+")")};var l=0,o;for(o=0;o<arguments.length;o++){l+=arguments[o]};var I=Math.random(),i=0;for(o=0;o<arguments.length;o++){i+=arguments[o]/l;if(I<i){O.select(o);break}}};SubShowClass.prototype.order=function(){var O=this;if(arguments.length!=O.label.length){throw new Error("order()参数错误:参数数量与标签数量不符!(length:"+arguments.length+")")};if(!(/^\d+$/).test(SubShowClass.sum)){return};var i=0,o;for(o=0;o<arguments.length;o++){i+=arguments[o]};var I=SubShowClass.sum%i;if(I==0){I=i};var l=0;for(o=0;o<arguments.length;o++){l+=arguments[o];if(l>=I){O.select(o);break}}};SubShowClass.prototype.play=function(spTime){if(typeof(spTime)=="number"){this.spaceTime=spTime};clearInterval(this.autoPlayTimeObj);this.autoPlayTimeObj=setInterval("SubShowClass.childs["+this.ID+"].autoPlayFunc()",this.spaceTime);this.autoPlay=true};SubShowClass.prototype.autoPlayFunc=function(){var i=this;if(i.autoPlay==false||i.mouseIn==true){return};i.nextLabel()};SubShowClass.prototype.nextLabel=function(){var index=this.selectedIndex;index++;if(index>=this.label.length){index=0};this.select(index);if(this.autoPlay==true){clearInterval(this.autoPlayTimeObj);this.autoPlayTimeObj=setInterval("SubShowClass.childs["+this.ID+"].autoPlayFunc()",this.spaceTime)}};SubShowClass.prototype.previousLabel=function(){var index=this.selectedIndex;index--;if(index<0){index=this.label.length-1};this.select(index);if(this.autoPlay==true){clearInterval(this.autoPlayTimeObj);this.autoPlayTimeObj=setInterval("SubShowClass.childs["+this.ID+"].autoPlayFunc()",this.spaceTime)}};SubShowClass.prototype.stop=function(){var i=this;clearInterval(i.autoPlayTimeObj);i.autoPlay=false};SubShowClass.$=function(objName){if(document.getElementById){return eval('document.getElementById("'+objName+'")')}else{return eval('document.all.'+objName)}};SubShowClass.readCookie=function(O){var o="",l=O+"=";if(document.cookie.length>0){var i=document.cookie.indexOf(l);if(i!=-1){i+=l.length;var I=document.cookie.indexOf(";",i);if(I==-1)I=document.cookie.length;o=unescape(document.cookie.substring(i,I))}};return o};SubShowClass.writeCookie=function(i,l,o,c){var O="",I="";if(o!=null){O=new Date((new Date).getTime()+o*3600000);O="; expires="+O.toGMTString()};if(c!=null){I=";domain="+c};document.cookie=i+"="+escape(l)+O+I};SubShowClass.sum=SubShowClass.readCookie("SSCSum");if((/^\d+$/).test(SubShowClass.sum)){SubShowClass.sum++}else{SubShowClass.sum=1};SubShowClass.writeCookie("SSCSum",SubShowClass.sum,12);

//checkForm.js
function checkForm(fm){for(var i=0;i<fm.length;i++){var title=fm[i].title;if(title=="")continue;var p=title.lastIndexOf("~");if(p<0)continue;var info=title.substring(0,p);var format=title.substring(p+1,title.length);var name=fm[i].name;if(name=="")continue;var value=trim(fm[i].value);if(fm[i].type=="radio"){if(checkRadio(fm,fm[i])){continue}else{return false}}if(fm[i].type=="checkbox"){if(checkCheckbox(fm,fm[i])){continue}else{return false}}if(fm[i].type=="select-one"){if(checkSelectOne(fm[i])){continue}else{return false}}if(fm[i].type=="select-multiple"){if(checkSelectMultiple(fm[i])){continue}else{return false}}var notNull=false;if(format.charAt(format.length-1)=="!"){notNull=true;format=format.substring(0,format.length-1)}if(notNull){if(value==""){alert(info+"\n"+name+"的内容不可以为空。");fm[i].focus();return false}}else{if(value=="")continue}var colonP=format.indexOf(":");if(colonP>0){if(format.charAt(colonP-1)=='f'){var lengthLimit=format.substring(0,colonP-1);if(!isNaN(lengthLimit)){if(value.length!=lengthLimit){alert(info+"\n"+name+"的长度为"+value.length+"位，必须为"+lengthLimit+"位");fm[i].focus();return false}}}else{var lengthLimit=format.substring(0,colonP);if(!isNaN(lengthLimit)){if(value.length>lengthLimit){alert(info+"\n"+name+"的长度("+value.length+")超过限制"+lengthLimit);fm[i].focus();return false}}}format=format.substring(colonP+1,format.length)}if(format=="email"){var found=value.match(/\w+@.+\..+/);if(found==null){alert(info+"\n"+name+"的格式不正确:\n\""+value+"\"不是一个Email地址");fm[i].focus();return false}}else if(format=="int"){var intVal=parseInt(value);if(isNaN(intVal)||intVal!=value){alert(info+"\n"+name+"的格式不正确:\n"+value+"不是一个整数。");fm[i].focus();return false}}else if(format=="float"){var floatVal=parseFloat(value);if(isNaN(floatVal)||floatVal!=value){alert(info+"\n"+name+"的格式不正确:\n"+value+"不是一个浮点数。");fm[i].focus();return false}}else if(format=="date"){var found=value.match(/(\d{1,5})-(\d{1,2})-(\d{1,2})/);if(found==null||found[0]!=value||found[2]>12||found[3]>31){alert(info+"\n"+name+"的格式不正确:\n\""+value+"\"不是一个日期\n提示：[2000-01-01]");fm[i].focus();return false}var year=trim0(found[1]);var month=trim0(found[2])-1;var date=trim0(found[3]);var d=new Date(year,month,date);if(d.getFullYear()!=year||d.getMonth()!=month||d.getDate()!=date){alert(info+"\n"+name+"的内容不正确:\n\""+value+"\"不是一个正确的日期\n提示：[2000-01-01]");fm[i].focus();return false}}else if(format=="time"){var found=value.match(/(\d{2}):(\d{2}):(\d{2})/);if(found==null||found[0]!=value||found[1]>23||found[2]>59||found[3]>59){alert(info+"\n"+name+"的格式不正确:\n\""+value+"\"不是一个时间\n提示：[05:38:00]");fm[i].focus();return false}}else if(format=="hasChinese"){var _hasChinese=false;for(var j=0;j<value.length;j++){if(value.charCodeAt(j)>255){_hasChinese=true;break}}if(!_hasChinese){alert(info+"\n"+name+"的内容需要中文:\n\""+value+"\"不含有任何中文字符");fm[i].focus();return false}}else if(format=="allChinese"){for(var j=0;j<value.length;j++){if(value.charCodeAt(j)<=255){alert(info+"\n"+name+"的内容要求全中文:\n\""+value+"\"含有非中文字符");fm[i].focus();return false}}}else if(format=="noChinese"){for(var j=0;j<value.length;j++){if(value.charCodeAt(j)>255){alert(info+"\n"+name+"的内容要求非中文:\n\""+value+"\"含有中文字符");fm[i].focus();return false}}}else if(format!=""){try{var found=value.match(eval(format));if(found==null||found[0]!=value){alert(info+"\n"+name+"的格式不不符合要求:\""+value+"\"\n提示：["+format+"]");fm[i].focus();return false}}catch(e){alert(e.name+":\n["+fm[i].name+"]不合法的正则式\""+format+"\"");return false}}}return true}function checkRadio(fm,opt){var title=opt.title;if(title=="")return true;var p=title.lastIndexOf("~");if(p<0)return true;var info=title.substring(0,p);var format=title.substring(p+1,title.length);var name=opt.name;if(name=="")return true;if(format=="!"){if(typeof(fm.all[name].length)=="undefined"){if(opt.checked){return true}else{alert(info+"\n必须选择"+name);opt.focus();return false}}else{var radios=fm[name];for(var j=0;j<radios.length;j++){if(radios[j].checked==true)return true}alert(info+"\n必须选择"+name+"的一个选项");opt.focus();return false}}else{return true}}function checkCheckbox(fm,opt){var title=opt.title;if(title=="")return true;var p=title.lastIndexOf("~");if(p<0)return true;var info=title.substring(0,p);var format=title.substring(p+1,title.length);var name=opt.name;if(name=="")return true;var min=format.match(/min:(\d+)\w*/);var max=format.match(/\w*max:(\d+)/);if(typeof(fm.all[name].length)=="undefined"){if(min!=null){if(min[1]==1&&!opt.checked){alert(info+"\n必须选上"+name+"选项");opt.focus();return false}}}else{var checkboxes=fm.all[name];var check_count=0;for(var j=0;j<checkboxes.length;j++){if(checkboxes[j].checked)check_count++}if(min!=null){if(min[1]>check_count){alert(info+"\n"+name+"至少需要选择"+min[1]+"个选项");opt.focus();return false}}if(max!=null){if(max[1]<check_count){alert(info+"\n"+name+"至多可以选择"+max[1]+"个选项");opt.focus();return false}}}return true}function checkSelectOne(sel){var title=sel.title;if(title=="")return true;var p=title.lastIndexOf("~");if(p<0)return true;var info=title.substring(0,p);var format=title.substring(p+1,title.length);var name=sel.name;if(name=="")return true;if(format=="!"&&sel.selectedIndex==0){alert(info+"\n"+name+"不可以选择第一个个选项");sel.focus();return false}return true}function checkSelectMultiple(sel){var title=sel.title;if(title=="")return true;var p=title.lastIndexOf("~");if(p<0)return true;var info=title.substring(0,p);var format=title.substring(p+1,title.length);var name=sel.name;if(name=="")return true;var min=format.match(/min:(\d+)\w*/);var max=format.match(/\w*max:(\d+)/);var select_count=0;for(var j=0;j<sel.length;j++){if(sel[j].selected)select_count++}if(min!=null){if(min[1]>select_count){alert(info+"\n"+name+"至少需要选择"+min[1]+"个选项");sel.focus();return false}}if(max!=null){if(max[1]<select_count){alert(info+"\n"+name+"至多可以选择"+max[1]+"个选项");sel.focus();return false}}return true}function trim(s){s=s.replace(/^ */,"");s=s.replace(/ *$/,"");return s}function trim0(s){if(s.length==0)return s;s=s.replace(/^0*/,"");if(s.length==0)s="0";return s}function getQueryString(fm){var qStr="";for(var i=0;i<fm.length;i++){if(!fm[i].disabled){var n=fm[i].name;if(n==null)continue;if(n.length==0)continue;if(fm[i].type=="select-multiple"){var _vs=fm[i].options;for(var _j=0;_j<_vs.length;_j++){var _opt=_vs(_j);if(_opt.selected){var v=_opt.value;qStr=qStr+"&"+n+"="+ec(v)}}}else{var v=fm[i].value;if(fm[i].type=="radio"||fm[i].type=="checkbox"){if(!fm[i].checked)continue}qStr=qStr+"&"+n+"="+ec(v)}}}if(qStr.length>0)qStr="?"+qStr.substr(1);return qStr}function ec(va){return va.replace(/\n/g,"%0D%0A")}

/* 改变className begin */
function chgClassName(ObjId,className){GetObj(ObjId).className=className}
/* 改变className end */

/* ========== 舌签切换 begin ========== */
function chgTabs(TabNum,preTabId,TabId,preConId,ConId){for(var i=0;i<TabNum;i++){GetObj(preConId+i).style.display="none";chgClassName(preTabId+TabId,"")}GetObj(preConId+ConId).style.display="block";chgClassName(preTabId+TabId,"on")}
/* ========== 舌签切换 end ========== */